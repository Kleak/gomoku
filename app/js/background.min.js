function closeApp(){console.log("closeApp");if(Socket.isConnected())Socket.disconnect();chrome.alarms.clearAll();MainWindow.close()}function createWindow(){if(MainWindow&&!MainWindow.contentWindow.closed){MainWindow.focus()}else{chrome.app.window.create("window.html",{id:"MainWindow",resizable:false,frame:"none",minWidth:1e3,maxWidth:1e3,minHeight:800,maxHeight:800},function(e){MainWindow=e;MainWindow.contentWindow.socket={}||MainWindow.contentWindow.socket;MainWindow.contentWindow.socket.Create=function(e,t,n){Socket=new Sock(e,t,n);return Socket};MainWindow.contentWindow.socket.Write=function(e){Socket.write(e)};MainWindow.contentWindow.socket.Read=function(e){Socket.read(e)};MainWindow.contentWindow.socket.Disconnect=function(){Socket.disconnect()};MainWindow.contentWindow.socketIsConnected=function(){return Socket.isConnected()};MainWindow.contentWindow.closeApp=closeApp})}}var MainWindow=null;var Socket=null;chrome.app.runtime.onLaunched.addListener(createWindow);chrome.app.window.onClosed.addListener(closeApp);chrome.alarms.onAlarm.addListener(function(e){if(e.name=="socketUpdate"){Socket.updateInfo()}})